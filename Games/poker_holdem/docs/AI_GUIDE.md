# AI玩家功能说明

## 概述

本游戏内置了基于规则的智能AI玩家系统，可以在缺少真人玩家时提供对手，让你随时享受德州扑克的乐趣。

## AI特性

### 🧠 智能决策系统

AI玩家具备以下能力：

1. **起手牌评估** - 能够准确评估翻牌前的手牌强度
2. **牌型识别** - 实时评估当前牌型和潜在牌型
3. **赔率计算** - 基于底池赔率做出决策
4. **位置感知** - 考虑庄家位置和下注顺序
5. **诈唬能力** - 根据性格设置进行适当诈唬
6. **动态调整** - 根据游戏阶段调整策略

### 🎭 四种性格类型

#### 1. 紧凶型 (Tight-Aggressive) 🔥

**特点**：
- 只玩好牌，挑剔起手牌
- 一旦参与就下注激进
- 很少诈唬，可信度高

**参数**：
- 激进度: 0.8
- 紧度: 0.8
- 诈唬频率: 0.1

**适合对抗**：初学者，比较稳健

**典型行为**：
- 持有AA、KK、AK等强牌时大幅加注
- 中等牌快速弃牌
- 翻牌后继续施压

#### 2. 松凶型 (Loose-Aggressive) 💥

**特点**：
- 玩很多牌，不挑剔
- 频繁加注施压
- 诈唬频率高，难以预测

**参数**：
- 激进度: 0.9
- 紧度: 0.3
- 诈唬频率: 0.3

**适合对抗**：有经验的玩家，喜欢激进打法

**典型行为**：
- 几乎每手都参与
- 大量加注和再加注
- 用弱牌诈唬

#### 3. 被动型 (Passive) 😌

**特点**：
- 跟注为主
- 很少主动加注
- 保守谨慎

**参数**：
- 激进度: 0.3
- 紧度: 0.6
- 诈唬频率: 0.05

**适合对抗**：激进型玩家，容易被压制

**典型行为**：
- 持有好牌也只是跟注
- 遇到加注容易弃牌
- 到河牌才显示实力

#### 4. 平衡型 (Balanced) ⚖️

**特点**：
- 根据情况灵活调整
- 攻守兼备
- 最难预测

**参数**：
- 激进度: 0.6
- 紧度: 0.5
- 诈唬频率: 0.15

**适合对抗**：所有类型玩家，最全面

**典型行为**：
- 好牌加注，中牌跟注，弱牌弃牌
- 根据底池大小调整下注
- 适度诈唬保持不可预测性

## 使用方法

### 方式一：通过界面添加

1. 进入游戏后，点击"添加AI玩家"按钮
2. 每次点击添加1个AI玩家
3. 最多可添加至8名玩家（包括真人）
4. AI玩家会自动分配不同性格

### 方式二：通过API添加

```bash
# 添加1个AI玩家
curl -X POST http://localhost:8000/api/add_ai?count=1

# 添加3个AI玩家
curl -X POST http://localhost:8000/api/add_ai?count=3

# 响应示例
{
    "status": "success",
    "added": 3,
    "total_players": 4
}
```

### 方式三：游戏开始前批量添加

通过WebSocket发送消息：

```javascript
ws.send(JSON.stringify({
    type: "add_ai",
    count: 3
}));
```

## AI决策逻辑

### 翻牌前（Preflop）

AI根据以下因素评估起手牌：

1. **对子价值**
   - AA、KK、QQ: 0.9+ (极强)
   - JJ、TT、99: 0.7-0.8 (强)
   - 88-22: 0.5-0.7 (中等)

2. **大牌组合**
   - AK同花: 0.9+ (极强)
   - AK不同花: 0.8+ (强)
   - AQ、AJ、KQ: 0.6-0.8 (中上)

3. **同花加成** +0.1
4. **连牌加成** +0.05

### 翻牌后（Postflop）

AI根据以下因素决策：

1. **牌型强度**
   - 皇家同花顺: 1.0
   - 同花顺: 0.98
   - 四条: 0.95
   - 葫芦: 0.85
   - 同花: 0.8
   - 顺子: 0.7
   - 三条: 0.6
   - 两对: 0.5
   - 一对: 0.3
   - 高牌: 0.1

2. **底池赔率**
   ```
   赔率 = 需要跟注 / (底池 + 需要跟注)
   
   如果手牌强度 > 赔率 + 0.2:
       考虑跟注或加注
   否则:
       考虑弃牌
   ```

3. **位置因素**
   - 后位更激进
   - 前位更保守

4. **游戏阶段**
   - 翻牌: 探索性下注
   - 转牌: 加大压力
   - 河牌: 价值下注或诈唬

## AI行动示例

### 示例1：持有AA的紧凶型AI

```
翻牌前：大幅加注（3-4倍大盲）
翻牌：持续下注（0.5-1倍底池）
转牌：继续施压（0.8-1.2倍底池）
河牌：价值下注（1-1.5倍底池）
```

### 示例2：持有72的松凶型AI

```
翻牌前：跟注或小额加注（尝试偷盲）
翻牌：
  - 如果击中: 正常下注
  - 如果未击中: 30%概率诈唬，70%弃牌
```

### 示例3：持有AK的平衡型AI

```
翻牌前：标准加注（2.5-3倍大盲）
翻牌：
  - 击中A或K: 持续下注
  - 未击中但有同花/顺子听牌: 跟注
  - 完全未击中: 根据赔率决定
转牌：根据牌面强度调整
河牌：击中则价值下注，未击中则放弃
```

## 对抗AI策略

### 对抗紧凶型

✅ **有效策略**：
- 小牌偷盲
- 避免与其硬碰硬
- 他加注时要有好牌才跟

❌ **避免**：
- 用弱牌跟注大额加注
- 尝试诈唬他

### 对抗松凶型

✅ **有效策略**：
- 等待好牌陷阱
- 用强牌慢打
- 让他诈唬

❌ **避免**：
- 被他的气势压制
- 过度防守

### 对抗被动型

✅ **有效策略**：
- 频繁加注施压
- 偷盲偷底池
- 控制节奏

❌ **避免**：
- 他突然加注时要小心（通常有强牌）

### 对抗平衡型

✅ **有效策略**：
- 混合打法
- 观察模式
- 根据情况调整

❌ **避免**：
- 固定套路（容易被看穿）

## 性能指标

- **决策速度**: 1-2秒（模拟人类思考）
- **准确率**: 起手牌评估95%准确
- **性格一致性**: 90%以上
- **诈唬成功率**: 15-30%（取决于性格）

## AI局限性

当前AI是基于规则的系统，有以下局限：

1. **不会学习** - 不会根据玩家行为调整策略
2. **不会读人** - 不会根据玩家历史判断
3. **模式固定** - 长期对战可能被发现规律
4. **简单数学** - 只考虑基本赔率，不考虑隐含赔率
5. **无位置优化** - 位置策略较为简单

## 未来改进

- [ ] 使用机器学习优化决策
- [ ] 增加对玩家行为的记忆
- [ ] 实现更复杂的诈唬策略
- [ ] 添加隐含赔率计算
- [ ] 增加更多性格类型
- [ ] 实现自适应学习

## 调试模式

如需查看AI决策过程，可以在服务器日志中查看：

```bash
# 修改main.py，添加日志
import logging
logging.basicConfig(level=logging.DEBUG)

# 查看日志
docker-compose logs -f
# 或
tail -f server.log
```

## 常见问题

### Q: AI会作弊吗？

A: 不会。AI只能看到自己的手牌，和真人玩家获得的信息完全相同。

### Q: AI决策时间可以调整吗？

A: 可以。修改`main.py`中的`await asyncio.sleep(1.5)`，降低数字可加快速度。

### Q: 可以自定义AI性格吗？

A: 可以。修改`ai_player.py`中的性格参数：
```python
self.aggression = 0.7  # 激进度
self.tightness = 0.6   # 紧度
self.bluff_frequency = 0.2  # 诈唬频率
```

### Q: AI会互相串通吗？

A: 不会。每个AI都是独立决策，互不影响。

### Q: 能否增加AI难度？

A: 可以通过调整参数或修改决策算法来增加难度。

## 测试AI

运行AI测试：

```bash
python test_ai.py
```

测试内容：
- 手牌评估准确性
- 决策逻辑正确性
- 性格参数验证
- 游戏集成测试

---

**享受与AI对战的乐趣！** 🤖🃏
